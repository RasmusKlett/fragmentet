<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
    {% load staticfiles %}
    <link rel="stylesheet" href={% static 'style.css'%} />
    <title>{% block title %}Fragmentet{% endblock %}</title>
    <script>
    function setsubpage(e, path) {
        if (path==null){
            path = '';
        }
        console.log(e);
        e.preventDefault();
        var xmlhttp;
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        }
        else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () {
            console.log(e);
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var headerindex = xmlhttp.responseText.indexOf("__AJAX__");
                //var teststring = "test testa test";
                //console.log(teststring.indexOf("a"));
                //console.log(teststring.indexOf("b"));
                //////////////console.log(headerindex)
                //console.log(xmlhttp.responseText.length);
                if (headerindex < 100) {
                    var pageTitle = xmlhttp.responseText.substring(0,headerindex);
                    var content = xmlhttp.responseText.substring(headerindex + 9);
                    document.title = pageTitle;
                    document.getElementById("content").innerHTML = content;
                    window.history.pushState({"content":content,"pageTitle":pageTitle},"", path);
                }
                else {
                    window.location = path
                }
                //console.log(xmlhttp);
            }
        }
        xmlhttp.open("GET", path, true);
        xmlhttp.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        xmlhttp.send();
    }
    window.onpopstate = function(e){
        console.log('popstate')
        if(e.state){
            document.getElementById("content").innerHTML = e.state.content;
            document.title = e.state.pageTitle;
        }
    };
    </script>
</head>
<body>
<div id="parentdiv" class="wrap">
    <h1 class="wrap" display=block;><img src={%static 'logo.jpg' %} alt=Fragmentet></h1>
    <div id="header" class="wrap">
    <ul id="nav-global" class="wrap">
        <li><a href="/" onclick="setsubpage('/');">Hjem</a></li>
        <li><a href="/events" onclick="return !setsubpage('/events');"> Forestillinger</a></li>
        <li><a href="/" onclick="return !setsubpage('/');"> Om Teatret</a></li>
        <li><a href="/" onclick="return !setsubpage('/');"> Tidligere Forestillinger</a></li>
        <li><a href="/" onclick="return !setsubpage('/');"> Medlemskab</a></li>
        <li><a href="/" onclick="return !setsubpage('/');"> Kontakt</a></li>
    </ul>
    </div>
    <div id="content">
    {% block content %}{% endblock %}
    </div>
</div>
    {% block footer %}
    <hr>
    <p></p>
    {% endblock %}
</body>
</html>
